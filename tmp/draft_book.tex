\documentclass[autodetect-engine,dvi=dvipdfmx,11pt]{scrreprt}
%
% Layout
\usepackage{geometry}
\geometry{
  a4paper,
  left=35mm,
  right=35mm,
  top=30mm,
  bottom=30mm,
  heightrounded,
}
%
% Font
\usepackage{fontspec}
%
% % English fonts
% \setmainfont[%
%  % UprightFont = {MinionPro-Regular},%
%  % BoldFont={MinionPro-Bold},%
%  % ItalicFont={MinionPro-It},%
%  % BoldItalicFont={MinionPro-BoldIt},%
%  UprightFont = {SourceHanSerifSC-Regular},%
%  BoldFont={SourceHanSansSC-Bold},%
%  ItalicFont={SourceHanSerifSC-It},%
%  % ItalicFont={sarasa-mono-sc-nerd-lightitalic},%
%  % BoldItalicFont={sarasa-mono-sc-nerd-italic},%
%  ]{SourceHanSerifSC-Regular}
% %
% % Latin Font
% \setromanfont[Numbers={OldStyle},Ligatures={Common}]{SourceHanSerifSC-Regular}
% \setsansfont[Ligatures={Common}]{SourceHanSansSC-Regular}
% \setmonofont[Scale=0.72]{SourceHanSansSC-Regular}
%
% CJK font
\usepackage{xeCJK}
\defaultCJKfontfeatures{Scale=MatchLowercase}
\setCJKmainfont[%
 UprightFont = {SourceHanSerifSC-Regular},%
 BoldFont={SourceHanSansSC-Regular},%
 BoldItalicFont={SourceHanSansSC-Regular},%
 ]{SourceHanSerifSC-Regular}
\setCJKsansfont{SourceHanSansSC-Regular}
%
% Basic
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{textcomp}
\usepackage{multicol}
\usepackage{amsmath,amsthm,amssymb}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{url}
\usepackage{appendix}
%
% Extra
\usepackage{minted}
\usepackage{csquotes}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usetikzlibrary{shapes.geometric}
\usepackage{svg}
%
% Date
\usepackage[yyyymmdd]{datetime}
\renewcommand{\dateseparator}{-}
%
% Color link
\usepackage{xcolor}
\usepackage{hyperref}
\ifdefined\kanjiskip
  \usepackage{pxjahyper}
  \hypersetup{%
    colorlinks=true,%
    citecolor=blue,%
  }
\else
  \ifdefined\XeTeXversion
  \hypersetup{%
    colorlinks=true,%
    citecolor=blue,%
  }
  \else
    \ifdefined\directlua
    \hypersetup{%
      pdfencoding=auto,%
      colorlinks=true,%
      citecolor=blue,%
    }
    \else
    \hypersetup{%
      unicode,%
      colorlinks=true,%
      citecolor=blue,%
    }
    \fi
  \fi
\fi
%
% Bibliography
\usepackage[%
  natbib,%
  style=apa,%
  backend=biber,%
  giveninits=false,%
]{biblatex}
%
% Verbatim
\usepackage{etoolbox}
\makeatletter
\patchcmd{\@verbatim}
  {\verbatim@font}
  {\verbatim@font\footnotesize}
  {}{}
\makeatother
%
% Footnote setting
\usepackage{footmisc}
\DefineFNsymbols{mySymbols}{{\ensuremath\dagger}{\ensuremath\ddagger}\S\P
   *{**}{\ensuremath{\dagger\dagger}}{\ensuremath{\ddagger\ddagger}}}
\setfnsymbol{mySymbols}
\renewcommand{\thefootnote}{\arabic{footnote}\enspace}
%
% header
\usepackage{fancyhdr}
\pagestyle{fancyplain}
\fancyhf{}
\lhead{\fancyplain{}{draft: \jobname}}
\rhead{\fancyplain{}{latest update: \today\enspace\currenttime}}
\cfoot{\fancyplain{}{\thepage}}
%
% caption
\usepackage{capt-of}
\usepackage{caption}
\captionsetup{%
  labelfont={bf},%
  labelsep=colon,%
  justification=raggedright,%
  format=hang,%
}
\usepackage{subcaption}
\captionsetup[sub]{%
  labelfont={bf},%
  labelsep=colon,%
  margin=0pt,%
}
% 
% Quote
\usepackage{framed}
\renewenvironment{quote}[1][\hsize]
{%
  \def\FrameCommand
  {%
    {\color{gray}\vrule width 4pt}%
    \hspace{0pt}%must no space.
    \fboxsep=\FrameSep\colorbox{white}%
  }
  \MakeFramed{\hsize#1\advance\hsize-\width\FrameRestore}
}
{\endMakeFramed}
%
% cleveref
\usepackage[capitalize,noabbrev]{cleveref}
\crefformat{section}{\S#2#1#3}
\crefformat{subsection}{\S#2#1#3}
\crefformat{subsubsection}{\S#2#1#3}
\crefrangeformat{section}{\S\S#3#1#4 to~#5#2#6}
\crefmultiformat{section}{\S\S#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}
